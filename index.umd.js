!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?t(require("react/jsx-runtime"),require("react-dom"),require("react")):"function"==typeof define&&define.amd?define(["react/jsx-runtime","react-dom","react"],t):t((e="undefined"!=typeof globalThis?globalThis:e||self).ReactJSXRuntime,e.ReactDOM,e.React)}(this,function(e,t,r){"use strict";function o(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}var n,a={};const s=o(function(){if(n)return a;n=1;var e=t;return a.createRoot=e.createRoot,a.hydrateRoot=e.hydrateRoot,a}()),i=[{role:"character",content:"¡Qué quieres, forastero! No tengo tiempo para tus tonterías."}];function c(){const[t,o]=r.useState(i),[n,a]=r.useState(""),[s,c]=r.useState(!1),l=r.useRef(null);r.useEffect(()=>{l.current?.scrollIntoView({behavior:"smooth"})},[t]);return e.jsxs("div",{style:d.chatContainer,children:[e.jsxs("div",{style:d.messagesContainer,children:[t.map((t,r)=>e.jsxs("div",{style:"user"===t.role?d.userMessage:d.characterMessage,children:[e.jsxs("strong",{children:["user"===t.role?"Tú:":"Drok:"," "]})," ",t.content]},r)),e.jsx("div",{ref:l})]}),e.jsxs("form",{onSubmit:async e=>{if(e.preventDefault(),!n.trim()||s)return;const r={role:"user",content:n.trim()};o(e=>[...e,r]),a(""),c(!0);try{const e={systemInstruction:"Eres Drok, un enano gruñón de la facción Hacha de Piedra. Responde siempre de manera concisa y desconfiada.",conversationHistory:[...t,r]},n=await fetch("https://cors-anywhere.herokuapp.com/https://script.google.com/macros/s/AKfycbyaIm0GQL0am6B0PjR8T_JPUtr_7nQQtDGaCwUZZjUp4hd0PAGyytz2JBClqyzNAH86nQ/exec",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(e)}),a=await n.text();if(!n.ok)throw new Error(`Error en el backend (${n.status}): ${a||n.statusText}`);const s={role:"character",content:(a?JSON.parse(a):{}).text||"Lo siento, tuve problemas para contactar a mi clan."};o(e=>[...e,s])}catch(i){console.error("Error al obtener respuesta de Gemini:",i);const e={role:"system",content:`Error: ${i instanceof Error?i.message:String(i)}`};o(t=>[...t,e])}finally{c(!1)}},style:d.inputForm,children:[e.jsx("input",{type:"text",value:n,onChange:e=>a(e.target.value),placeholder:s?"El enano está pensando...":"Pregúntale algo al enano...",disabled:s,style:d.inputField}),e.jsx("button",{type:"submit",disabled:s,style:d.sendButton,children:s?"⏳":"Enviar"})]})]})}const d={chatContainer:{maxWidth:"500px",margin:"20px auto",border:"1px solid #ccc",borderRadius:"8px",boxShadow:"0 2px 5px rgba(0,0,0,0.1)",backgroundColor:"#fff",height:"400px",display:"flex",flexDirection:"column"},messagesContainer:{padding:"10px",overflowY:"auto",flexGrow:1,borderBottom:"1px solid #eee"},userMessage:{textAlign:"right",backgroundColor:"#e6f7ff",padding:"8px",borderRadius:"5px",marginBottom:"5px"},characterMessage:{textAlign:"left",backgroundColor:"#f5f5f5",padding:"8px",borderRadius:"5px",marginBottom:"5px"},inputForm:{display:"flex",padding:"10px",borderTop:"1px solid #eee"},inputField:{flexGrow:1,padding:"10px",border:"1px solid #ccc",borderRadius:"5px",marginRight:"10px"},sendButton:{padding:"10px 15px",border:"none",borderRadius:"5px",backgroundColor:"#007bff",color:"white",cursor:"pointer"}};window.ReactCharacterChat={render:(t,r)=>{s.createRoot(r).render(e.jsx(c,{...t}))}}});
